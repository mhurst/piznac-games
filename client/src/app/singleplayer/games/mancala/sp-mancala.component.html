<div class="game-container">
  @if (!gameStarted) {
    <div class="setup-panel">
      <h2>Mancala vs AI</h2>

      <div class="option-group">
        <label>Difficulty</label>
        <mat-button-toggle-group [(ngModel)]="difficulty" class="difficulty-toggle">
          <mat-button-toggle value="easy">Easy</mat-button-toggle>
          <mat-button-toggle value="medium">Medium</mat-button-toggle>
          <mat-button-toggle value="hard">Hard</mat-button-toggle>
        </mat-button-toggle-group>
      </div>

      <div class="option-group">
        <label>Play as</label>
        <mat-button-toggle-group [(ngModel)]="playerSide" class="symbol-toggle">
          <mat-button-toggle [value]="1">Player 1 (First)</mat-button-toggle>
          <mat-button-toggle [value]="2">Player 2 (Second)</mat-button-toggle>
        </mat-button-toggle-group>
      </div>

      <button mat-raised-button color="primary" (click)="startGame()" class="start-btn">
        Start Game
      </button>

      <button mat-stroked-button (click)="leaveGame()" class="back-btn">
        Back to Games
      </button>
    </div>
  }

  @if (gameStarted) {
    <div class="score-display">
      <span class="player-score">You: {{ playerScore }}</span>
      <span class="divider">|</span>
      <span class="ai-score">AI: {{ aiScore }}</span>
      <span class="difficulty-badge">{{ difficulty | titlecase }}</span>
    </div>
  }

  <div #gameCanvas class="game-canvas" [class.hidden]="!gameStarted"></div>

  @if (gameStarted) {
    <div class="game-controls">
      @if (gameOver) {
        <button mat-raised-button color="primary" (click)="playAgain()">
          Play Again
        </button>
        <button mat-stroked-button (click)="resetScore()">
          Reset Score
        </button>
      }
      <button mat-stroked-button (click)="leaveGame()">Leave Game</button>
    </div>

    <div class="how-to-play">
      <h3>How to Play</h3>
      <ul>
        <li>Click one of your pits (bottom row) to pick up all its stones.</li>
        <li>Stones are dropped one at a time going counter-clockwise.</li>
        <li>Your opponent's store is skipped when dropping stones.</li>
        <li>If your last stone lands in your store, you get an extra turn.</li>
        <li>If your last stone lands in an empty pit on your side and the opposite pit has stones, you capture both into your store.</li>
        <li>The game ends when one side is completely empty. Remaining stones go to that side's store.</li>
        <li>The player with the most stones in their store wins!</li>
      </ul>
    </div>
  }
</div>
